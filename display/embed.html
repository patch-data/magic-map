<!DOCTYPE html>

<html>
	<head>
		<title>Magic Map</title>
		<link href="css/fluid_base.css" rel="stylesheet">
		
		 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
		 <!--[if lte IE 8]>
			 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.ie.css" />
		 <![endif]-->
		 
		  <script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
		  <script src="js/patches.js"></script>
	</head>
	
	<body>
		<div id="header">
			Header content
		</div>
		<div id="map-canvas">
		</div>
		<div id="footer">
			Footer content
		</div>
		
		<script>
		

		function localize(){
    	
    	// Load the list of Patches in the header - relies on patches.js being present
		
		var subdomain = document.referrer.slice(document.referrer.indexOf('//') + 2).split('.')[0];
		var domain = document.referrer.slice(document.referrer.indexOf('//') + 2).split('.')[1];
		
		if (domain == "patch" && lookup[subdomain]) {			
			map.panTo(lookup[subdomain]);
    	} else {
    		subdomain = 'southorange';
    		map.panTo(lookup[subdomain]);
    	}
		
		}
		
		var map = L.map('map-canvas').setView([51.505, -0.09], 11);
		
		L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(map);
		
		localize();
		
		</script>
		
	</body>
</html>